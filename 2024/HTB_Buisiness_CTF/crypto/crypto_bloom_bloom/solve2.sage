from binascii import hexlify, unhexlify
from Crypto.Util.number import *
from Crypto.Cipher import AES
from output import cipher

p1 = (1, 27006418753792019267647881709336369603809025474153761185424552629526746515909)
p2 = (2, 76590454267924193303526931251420387908730989759486987968207839464816350274449)
p3 = (3, 67564500698667187837224046797217120599664632018519685208508601443605280795068)
p4 = (4, 57120102994643471094254225269948720992016639286627873340589938545214763610538)
p5 = (5, 87036956450994410488989322365773556006053008613964544744444104769020810012336)

P = [p1, p2, p3, p4, p5]

F = GF(88061271168532822384517279587784001104302157326759940683992330399098283633319)
R = F["x"]

f = list(R.lagrange_polynomial(P))
key = long_to_bytes(int(f[0]))

print(key)

aes = AES.new(key, AES.MODE_ECB)
flag = aes.decrypt(unhexlify(cipher))
print(flag)
